<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting · NoLimits.jl</title><meta name="title" content="Plotting · NoLimits.jl"/><meta property="og:title" content="Plotting · NoLimits.jl"/><meta property="twitter:title" content="Plotting · NoLimits.jl"/><meta name="description" content="Documentation for NoLimits.jl."/><meta property="og:description" content="Documentation for NoLimits.jl."/><meta property="twitter:description" content="Documentation for NoLimits.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NoLimits.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../capabilities/">Capabilities</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Building</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../model-building/">Overview</a></li><li><a class="tocitem" href="../model-building/model-macro/">@Model</a></li><li><a class="tocitem" href="../model-building/helpers/">@helpers</a></li><li><a class="tocitem" href="../model-building/fixed-effects/">@fixedEffects</a></li><li><a class="tocitem" href="../model-building/covariates/">@covariates</a></li><li><a class="tocitem" href="../model-building/random-effects/">@randomEffects</a></li><li><a class="tocitem" href="../model-building/pre-differential-equation/">@preDifferentialEquation</a></li><li><a class="tocitem" href="../model-building/differential-equation/">@DifferentialEquation</a></li><li><a class="tocitem" href="../model-building/initial-de/">@initialDE</a></li><li><a class="tocitem" href="../model-building/formulas/">@formulas</a></li><li><a class="tocitem" href="../model-building/universal-function-approximators/">Function Approximators (NNs + SoftTrees)</a></li></ul></li><li><a class="tocitem" href="../data-model-construction/">Data Model Construction</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../estimation/">Overview</a></li><li><a class="tocitem" href="../estimation/laplace/">Laplace</a></li><li><a class="tocitem" href="../estimation/laplace-map/">Laplace MAP</a></li><li><a class="tocitem" href="../estimation/mcem/">MCEM</a></li><li><a class="tocitem" href="../estimation/saem/">SAEM</a></li><li><a class="tocitem" href="../estimation/mcmc/">MCMC</a></li><li><a class="tocitem" href="../estimation/vi/">VI</a></li><li><a class="tocitem" href="../estimation/mle/">MLE</a></li><li><a class="tocitem" href="../estimation/mle-map/">MAP</a></li><li><a class="tocitem" href="../estimation/multistart/">Multistart</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Uncertainty Quantification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../uncertainty-quantification/">Overview</a></li><li><a class="tocitem" href="../uncertainty-quantification/wald/">Wald</a></li><li><a class="tocitem" href="../uncertainty-quantification/profile-likelihood/">Profile likelihood</a></li><li><a class="tocitem" href="../uncertainty-quantification/mcmc-based-uncertainty/">MCMC-based uncertainty</a></li></ul></li><li class="is-active"><a class="tocitem" href>Plotting</a><ul class="internal"><li><a class="tocitem" href="#Plotting-APIs"><span>Plotting APIs</span></a></li><li><a class="tocitem" href="#Executable-setup"><span>Executable setup</span></a></li><li><a class="tocitem" href="#Reusing-computations-with-build_plot_cache"><span>Reusing computations with <code>build_plot_cache</code></span></a></li><li><a class="tocitem" href="#Data-plot"><span>Data plot</span></a></li><li><a class="tocitem" href="#Fitted-trajectories"><span>Fitted trajectories</span></a></li><li><a class="tocitem" href="#Multistart-objective-value-plot"><span>Multistart objective-value plot</span></a></li><li><a class="tocitem" href="#Fitted-trajectory-comparison-across-models"><span>Fitted trajectory comparison across models</span></a></li><li><a class="tocitem" href="#Multistart-fixed-effect-variability"><span>Multistart fixed-effect variability</span></a></li><li><a class="tocitem" href="#Observation-distribution-diagnostic"><span>Observation distribution diagnostic</span></a></li><li><a class="tocitem" href="#Residual-QQ-diagnostic"><span>Residual QQ diagnostic</span></a></li><li><a class="tocitem" href="#Visual-predictive-check"><span>Visual predictive check</span></a></li><li><a class="tocitem" href="#Random-effects-distribution-diagnostic"><span>Random-effects distribution diagnostic</span></a></li><li><a class="tocitem" href="#Uncertainty-quantification-plot"><span>Uncertainty quantification plot</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/mixed-effects-multiple-methods/">Mixed-Effects Tutorial 1: Nonlinear Random-Effects Model Across Multiple Estimation Methods</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-ode-mcem/">Mixed-Effects Tutorial 2: ODE Model with Dosing Events (MCEM)</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-nn-saem/">Mixed-Effects Tutorial 3: Neural Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-softtree-saem/">Mixed-Effects Tutorial 4: SoftTree Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-seizure-counts-poisson-nb-mcem/">Mixed-Effects Tutorial 5: Seizure Counts with Poisson and NegativeBinomial Outcomes (MCEM)</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-left-censored-virload50-laplace/">Mixed-Effects Tutorial 6: Left-Censored Nonlinear Model (Laplace)</a></li><li><a class="tocitem" href="../tutorials/mixed-effects-vi/">Mixed-Effects Tutorial 7: Variational Inference (VI)</a></li><li><a class="tocitem" href="../tutorials/fixed-effects-nonlinear-mle-map/">Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a></li><li><a class="tocitem" href="../tutorials/fixed-effects-vi/">Fixed-Effects Tutorial 2: Variational Inference (VI)</a></li></ul></li><li><a class="tocitem" href="../how-to-contribute/">How to Contribute</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Plotting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl/blob/main/docs/src/plotting/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h1><p>Effective model assessment depends on graphical diagnostics that expose patterns invisible in summary statistics alone. NoLimits provides a unified plotting interface for data inspection, fitted-model evaluation, residual analysis, random-effects diagnostics, and uncertainty visualization. Each function targets a specific aspect of model adequacy – from individual-level trajectory fits to distributional calibration of predictions – and all follow a consistent API.</p><p>This page contains executable examples that render directly during the documentation build.</p><p>All plotting functions accept a file-path keyword for saving output directly:</p><ul><li><code>save_path=&quot;path/to/plot.png&quot;</code> (existing)</li><li><code>plot_path=&quot;path/to/plot.png&quot;</code> (alias)</li></ul><h2 id="Plotting-APIs"><a class="docs-heading-anchor" href="#Plotting-APIs">Plotting APIs</a><a id="Plotting-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-APIs" title="Permalink"></a></h2><p>The following functions are organized by the diagnostic question they address.</p><p><strong>Core trajectory and data plotting:</strong></p><ul><li><code>build_plot_cache</code>: Precompute reusable plot inputs (parameters, random effects, ODE solves, optional observation distributions) from a <code>FitResult</code> or <code>DataModel</code>. Avoids redundant computation when generating multiple plots from the same fit.</li><li><code>plot_data</code>: Plot observed trajectories by individual.</li><li><code>plot_fits</code>: Plot model-implied trajectories, with optional predictive-density overlays.</li><li><code>plot_fits_comparison</code>: Overlay fitted trajectories from multiple fit results on the same individual panels, enabling direct visual comparison of competing models or estimation methods.</li><li><code>plot_multistart_waterfall</code>: Plot successful multistart runs as objective-valued dots, sorted from best to worst by the package multistart ranking criterion.</li><li><code>plot_multistart_fixed_effect_variability</code>: Plot fixed-effect variability across top multistart runs as z-scores (single panel).</li></ul><p><strong>Observation and predictive diagnostics:</strong></p><ul><li><code>plot_observation_distributions</code>: Plot predictive outcome distributions at selected observations, with observed values overlaid. Reveals local miscalibration that aggregate summaries may obscure.</li><li><code>plot_vpc</code>: Visual predictive check comparing simulated observations with observed data. Provides a calibration assessment in the observation space.</li></ul><p><strong>Residual diagnostics:</strong></p><ul><li><code>get_residuals</code>: Return residual metrics in tabular form (<code>:quantile</code>, <code>:pit</code>, <code>:raw</code>, <code>:pearson</code>, <code>:logscore</code>).</li><li><code>plot_residuals</code>: Residuals versus a chosen x-axis variable (time or any varying covariate).</li><li><code>plot_residual_distribution</code>: Residual distribution histograms by observable.</li><li><code>plot_residual_qq</code>: QQ diagnostics for selected residual metrics.</li><li><code>plot_residual_pit</code>: Probability integral transform (PIT) diagnostics via histogram, KDE, or QQ view.</li><li><code>plot_residual_acf</code>: Residual autocorrelation by lag, useful for detecting unmodeled temporal structure.</li></ul><p><strong>Random-effects diagnostics:</strong></p><ul><li><code>plot_random_effects_pdf</code>: Marginal random-effect density, including posterior summaries for MCMC fits.</li><li><code>plot_random_effect_distributions</code>: Distribution-level diagnostics with empirical Bayes estimate (EBE) or posterior-mean overlays by level.</li><li><code>plot_random_effect_pit</code>: PIT diagnostics for random effects.</li><li><code>plot_random_effect_standardized</code>: Distribution of standardized EBEs, assessing whether the assumed random-effect variance is appropriate.</li><li><code>plot_random_effect_standardized_scatter</code>: Standardized EBEs versus level index or a constant covariate.</li><li><code>plot_random_effect_pairplot</code>: Pairwise EBE dependency visualization for detecting unexplained correlations.</li><li><code>plot_random_effects_scatter</code>: EBE or posterior-mean scatter versus level index or a constant covariate.</li></ul><p><strong>Uncertainty quantification diagnostics:</strong></p><ul><li><code>plot_uq_distributions</code>: Parameter uncertainty visualization from a <code>UQResult</code> (density or histogram).</li></ul><h2 id="Executable-setup"><a class="docs-heading-anchor" href="#Executable-setup">Executable setup</a><a id="Executable-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Executable-setup" title="Permalink"></a></h2><p>The following model and data are used throughout this page. The model specifies a linear trend with normally distributed random intercepts, fitted via the Laplace approximation. The data comprise four individuals, each observed at three time points.</p><pre><code class="language-julia hljs">using NoLimits
using DataFrames
using Distributions
using Random
using Turing

Random.seed!(12)

model = @Model begin
    @fixedEffects begin
        a = RealNumber(0.3, calculate_se=true)
        b = RealNumber(0.1, calculate_se=true)
        ω = RealNumber(0.4, scale=:log, calculate_se=true)
        σ = RealNumber(0.2, scale=:log, calculate_se=false)
    end

    @covariates begin
        t = Covariate()
    end

    @randomEffects begin
        η = RandomEffect(Normal(0.0, ω); column=:ID)
    end

    @formulas begin
        μ = a + b * t + exp(η)
        y ~ Normal(μ, σ)
    end
end

df = DataFrame(
    ID=repeat([:A, :B, :C, :D], inner=3),
    t=repeat([0.0, 1.0, 2.0], 4),
    y=[1.2, 1.6, 2.1, 1.1, 1.4, 1.8, 0.9, 1.1, 1.4, 1.3, 1.8, 2.2],
)

dm = DataModel(model, df; primary_id=:ID, time_col=:t)
res = fit_model(dm, NoLimits.Laplace(; optim_kwargs=(maxiters=8,)))
cache = build_plot_cache(res; cache_obs_dists=true)
nothing</code></pre><h2 id="Reusing-computations-with-build_plot_cache"><a class="docs-heading-anchor" href="#Reusing-computations-with-build_plot_cache">Reusing computations with <code>build_plot_cache</code></a><a id="Reusing-computations-with-build_plot_cache-1"></a><a class="docs-heading-anchor-permalink" href="#Reusing-computations-with-build_plot_cache" title="Permalink"></a></h2><p>Many diagnostic plots share the same underlying computations: parameter extraction, random-effect estimation, and (for ODE models) numerical integration. Calling <code>build_plot_cache</code> once stores these intermediate results so that subsequent plotting calls avoid redundant work.</p><p>The cache contains:</p><ul><li>Fixed effects used for plotting (including <code>params</code> overrides, when provided)</li><li>Random-effect values for each individual (respecting <code>constants_re</code>, when provided)</li><li>ODE solutions for each individual when the model includes a <code>@DifferentialEquation</code> block</li><li>Optional per-observation outcome distributions when <code>cache_obs_dists=true</code></li></ul><p>For MCMC fits, cache construction also accepts <code>mcmc_draws</code> and <code>mcmc_warmup</code> to control how posterior draws are summarized before plotting.</p><pre><code class="language-julia hljs">cache_fast = build_plot_cache(res; cache_obs_dists=false)
cache_full = build_plot_cache(
    res;
    cache_obs_dists=true,
    params=(a=0.35,),
    constants_re=(η=Dict(:A =&gt; 0.0),),
)
nothing</code></pre><h2 id="Data-plot"><a class="docs-heading-anchor" href="#Data-plot">Data plot</a><a id="Data-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Data-plot" title="Permalink"></a></h2><p>Before evaluating any fitted model, it is good practice to examine the raw observations. <code>plot_data</code> displays observed trajectories for each individual, providing an immediate sense of data coverage over time, individual-level variability, and potential outliers.</p><pre><code class="language-julia hljs">p_data = plot_data(res)
p_data</code></pre><img src="index-561936da.svg" alt="Example block output"/><h2 id="Fitted-trajectories"><a class="docs-heading-anchor" href="#Fitted-trajectories">Fitted trajectories</a><a id="Fitted-trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Fitted-trajectories" title="Permalink"></a></h2><p><code>plot_fits</code> overlays observed data with model-implied trajectories for each individual. This is the primary tool for assessing whether the structural model captures the dominant trends in the data and whether individual-level fits are adequate. Discrepancies visible here may indicate model misspecification or insufficient flexibility in the random-effects structure.</p><pre><code class="language-julia hljs">p_fits = plot_fits(res; cache=cache)
p_fits</code></pre><img src="index-0402cc0d.svg" alt="Example block output"/><h2 id="Multistart-objective-value-plot"><a class="docs-heading-anchor" href="#Multistart-objective-value-plot">Multistart objective-value plot</a><a id="Multistart-objective-value-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Multistart-objective-value-plot" title="Permalink"></a></h2><p>When the optimization landscape is multimodal, a single fit may converge to a local rather than global optimum. <code>plot_multistart_waterfall</code> visualizes the objective values from all successful multistart runs, sorted by rank. A flat plateau among the top runs suggests convergence to a consistent solution, while large gaps or a smooth decline may signal identifiability issues or the presence of multiple basins of attraction.</p><pre><code class="language-julia hljs">ms = NoLimits.Multistart(;
    dists=(; a=Normal(0.0, 0.5), b=Normal(0.0, 0.5)),
    n_draws_requested=3,
    n_draws_used=2,
    sampling=:lhs,
)

laplace_quick = NoLimits.Laplace(;
    optim_kwargs=(maxiters=4,),
    inner_kwargs=(maxiters=20,),
    multistart_n=0,
    multistart_k=0,
)

res_ms = fit_model(ms, dm, laplace_quick)
p_ms = plot_multistart_waterfall(res_ms)
p_ms</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip280">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(%23clip280)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="%23ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip281">
    <rect x="281" y="140" width="2041" height="1255"/>
  </clipPath>
</defs>
<path clip-path="url(%23clip280)" d="M281.529 1394.12 L2321.26 1394.12 L2321.26 140.596 L281.529 140.596  Z" fill="%23ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,1300.23 2321.26,1300.23 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,950.855 2321.26,950.855 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,601.477 2321.26,601.477 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,252.1 2321.26,252.1 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,1300.23 2321.26,1300.23 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,950.855 2321.26,950.855 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,601.477 2321.26,601.477 "/>
<polyline clip-path="url(%23clip281)" style="stroke:%23808080; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.3; fill:none" points="281.529,252.1 2321.26,252.1 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,1394.12 2321.26,1394.12 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,140.596 2321.26,140.596 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="339.258,1394.12 339.258,1375.22 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2263.53,1394.12 2263.53,1375.22 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="339.258,140.596 339.258,159.494 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2263.53,140.596 2263.53,159.494 "/>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 339.258, 1461.12)" x="339.258" y="1461.12">1</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 2263.53, 1461.12)" x="2263.53" y="1461.12">2</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:59px; text-anchor:middle;" transform="rotate(0, 1301.39, 1540.98)" x="1301.39" y="1540.98">Rank</text>
</g>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,1394.12 281.529,140.596 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2321.26,1394.12 2321.26,140.596 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,1300.23 300.427,1300.23 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,950.855 300.427,950.855 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,601.477 300.427,601.477 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.529,252.1 300.427,252.1 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2321.26,1300.23 2302.36,1300.23 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2321.26,950.855 2302.36,950.855 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2321.26,601.477 2302.36,601.477 "/>
<polyline clip-path="url(%23clip280)" style="stroke:%23000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2321.26,252.1 2302.36,252.1 "/>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 192.841, 1319.73)" x="192.841" y="1319.73">−3.1</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 192.841, 970.355)" x="192.841" y="970.355">−3.0</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 192.841, 620.977)" x="192.841" y="620.977">−2.9</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:53px; text-anchor:middle;" transform="rotate(0, 192.841, 271.6)" x="192.841" y="271.6">−2.8</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:59px; text-anchor:middle;" transform="rotate(-90, 92.878, 767.359)" x="92.878" y="767.359">Objective</text>
</g>
<g clip-path="url(%23clip280)">
<text style="fill:%23000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(0, 1301.39, 57.6)" x="1301.39" y="57.6">Multistart Objectives (best → worst; successful starts only)</text>
</g>
<circle clip-path="url(%23clip281)" cx="339.258" cy="1358.65" r="18" fill="%230072b2" fill-rule="evenodd" fill-opacity="0.7" stroke="%23000000" stroke-opacity="0.7" stroke-width="1.6"/>
<circle clip-path="url(%23clip281)" cx="2263.53" cy="176.073" r="18" fill="%230072b2" fill-rule="evenodd" fill-opacity="0.7" stroke="%23000000" stroke-opacity="0.7" stroke-width="1.6"/>
</svg>
'/><h2 id="Fitted-trajectory-comparison-across-models"><a class="docs-heading-anchor" href="#Fitted-trajectory-comparison-across-models">Fitted trajectory comparison across models</a><a id="Fitted-trajectory-comparison-across-models-1"></a><a class="docs-heading-anchor-permalink" href="#Fitted-trajectory-comparison-across-models" title="Permalink"></a></h2><p>Comparing fitted trajectories from different estimation methods or model specifications is a natural step in model selection. <code>plot_fits_comparison</code> overlays trajectories from multiple fit results on the same individual panels, making differences in structural predictions immediately visible.</p><p>For vectors, legend labels are assigned as <code>Model 1</code>, <code>Model 2</code>, and so on in input order. For <code>NamedTuple</code> and <code>Dict</code> inputs, the provided keys serve as legend labels. Per-model line styles can be customized through <code>PlotStyle(comparison_line_styles=Dict(...))</code>.</p><pre><code class="language-julia hljs">saem_quick = NoLimits.SAEM(;
    sampler=MH(),
    maxiters=20,
    mcmc_steps=8,
    t0=8,
    kappa=0.7,
    turing_kwargs=(n_samples=20, n_adapt=0, progress=false),
    optim_kwargs=(maxiters=80,),
    progress=false,
    verbose=false,
)
res_saem_quick = fit_model(dm, saem_quick; rng=Random.Xoshiro(24))
comparison_style = PlotStyle(comparison_line_styles=Dict(&quot;SAEM&quot; =&gt; :dash))
p_compare = plot_fits_comparison(
    (Laplace=res, SAEM=res_saem_quick);
    individuals_idx=1:2,
    style=comparison_style,
)
p_compare</code></pre><img src="index-1b4bf25d.svg" alt="Example block output"/><h2 id="Multistart-fixed-effect-variability"><a class="docs-heading-anchor" href="#Multistart-fixed-effect-variability">Multistart fixed-effect variability</a><a id="Multistart-fixed-effect-variability-1"></a><a class="docs-heading-anchor-permalink" href="#Multistart-fixed-effect-variability" title="Permalink"></a></h2><p>Beyond comparing objective values, it is informative to examine how fixed-effect estimates vary across top-ranked multistart runs. <code>plot_multistart_fixed_effect_variability</code> displays this variation as z-scores in a single panel, providing a concise summary of parameter stability across optimization restarts.</p><p>Configuration options:</p><ul><li><code>scale=:untransformed</code> (default): display parameters on the natural scale</li><li>Only top-level fixed-effect blocks with <code>calculate_se=true</code> are included by default</li><li><code>mode=:points</code> shows all values from the top-<code>k_best</code> runs; <code>mode=:quantiles</code> shows quantile summaries instead</li><li>Use <code>include_parameters</code> or <code>exclude_parameters</code> to select specific parameter blocks by name</li></ul><pre><code class="language-julia hljs">p_ms_var_points = plot_multistart_fixed_effect_variability(
    res_ms;
    k_best=3,
    mode=:points,
)
p_ms_var_points</code></pre><img src="index-1ee68298.svg" alt="Example block output"/><pre><code class="language-julia hljs">p_ms_var_quant = plot_multistart_fixed_effect_variability(
    res_ms;
    k_best=3,
    mode=:quantiles,
    quantiles=[0.1, 0.5, 0.9],
    include_parameters=[:σ],
)
p_ms_var_quant</code></pre><img src="index-08ddda94.svg" alt="Example block output"/><h2 id="Observation-distribution-diagnostic"><a class="docs-heading-anchor" href="#Observation-distribution-diagnostic">Observation distribution diagnostic</a><a id="Observation-distribution-diagnostic-1"></a><a class="docs-heading-anchor-permalink" href="#Observation-distribution-diagnostic" title="Permalink"></a></h2><p>Mean-level trajectory plots can mask important miscalibration in the predictive distribution. <code>plot_observation_distributions</code> addresses this by displaying the full predicted outcome distribution at selected observations alongside the observed value. When the observed value falls consistently in the tails of the predicted distribution, this signals that the assumed error model or its parameterization may need revision.</p><pre><code class="language-julia hljs">p_obs_dist = plot_observation_distributions(
    res;
    cache=cache,
    individuals_idx=1,
    obs_rows=2,
    observables=:y,
)
p_obs_dist</code></pre><img src="index-7b553f7b.svg" alt="Example block output"/><h2 id="Residual-QQ-diagnostic"><a class="docs-heading-anchor" href="#Residual-QQ-diagnostic">Residual QQ diagnostic</a><a id="Residual-QQ-diagnostic-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-QQ-diagnostic" title="Permalink"></a></h2><p>Quantile-quantile plots provide a sensitive assessment of whether residuals conform to their expected reference distribution. <code>plot_residual_qq</code> compares observed residual quantiles against theoretical quantiles; systematic departures from the diagonal indicate structural misspecification, heavy tails, or incorrect assumptions about the observation noise.</p><pre><code class="language-julia hljs">p_qq = plot_residual_qq(res; cache=cache, residual=:quantile)
p_qq</code></pre><img src="index-67e8b8bc.svg" alt="Example block output"/><h2 id="Visual-predictive-check"><a class="docs-heading-anchor" href="#Visual-predictive-check">Visual predictive check</a><a id="Visual-predictive-check-1"></a><a class="docs-heading-anchor-permalink" href="#Visual-predictive-check" title="Permalink"></a></h2><p>The visual predictive check (VPC) is a widely used diagnostic in longitudinal modelling. It evaluates a model&#39;s ability to reproduce the distribution of observed data through simulation. <code>plot_vpc</code> generates predictive envelopes from repeated simulations under the fitted model and overlays them on the observed data summaries. Agreement between the simulated envelopes and observed trends indicates that the model captures both the central tendency and the variability structure of the data.</p><pre><code class="language-julia hljs">p_vpc = plot_vpc(res; n_simulations=20, percentiles=[5, 50, 95])
p_vpc</code></pre><img src="index-af8e7e44.svg" alt="Example block output"/><h2 id="Random-effects-distribution-diagnostic"><a class="docs-heading-anchor" href="#Random-effects-distribution-diagnostic">Random-effects distribution diagnostic</a><a id="Random-effects-distribution-diagnostic-1"></a><a class="docs-heading-anchor-permalink" href="#Random-effects-distribution-diagnostic" title="Permalink"></a></h2><p>A well-specified random-effects model should produce empirical Bayes estimates consistent with the assumed distributional form. <code>plot_random_effects_pdf</code> overlays estimated random-effect values on the model-implied density, providing a direct visual check for distributional adequacy. Departures such as multimodality, skewness, or outlying values may indicate that a more flexible random-effects distribution is needed.</p><pre><code class="language-julia hljs">p_re_pdf = plot_random_effects_pdf(res)
p_re_pdf</code></pre><img src="index-47b8f176.svg" alt="Example block output"/><h2 id="Uncertainty-quantification-plot"><a class="docs-heading-anchor" href="#Uncertainty-quantification-plot">Uncertainty quantification plot</a><a id="Uncertainty-quantification-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Uncertainty-quantification-plot" title="Permalink"></a></h2><p>Reliable inference requires understanding the precision of parameter estimates. <code>plot_uq_distributions</code> visualizes parameter-level uncertainty from a computed <code>UQResult</code> object, revealing asymmetry, spread, and potential boundary effects that point summaries alone cannot convey. This is particularly informative for parameters estimated on transformed scales, where uncertainty may be highly asymmetric on the natural scale.</p><pre><code class="language-julia hljs">uq = compute_uq(res; method=:wald, n_draws=80, rng=Random.Xoshiro(7))
p_uq = plot_uq_distributions(uq; scale=:natural, plot_type=:density)
p_uq</code></pre><img src="index-6d9204b3.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../uncertainty-quantification/mcmc-based-uncertainty/">« MCMC-based uncertainty</a><a class="docs-footer-nextpage" href="../tutorials/mixed-effects-multiple-methods/">Mixed-Effects Tutorial 1: Nonlinear Random-Effects Model Across Multiple Estimation Methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Wednesday 25 February 2026 18:47">Wednesday 25 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wald · NoLimits.jl</title><meta name="title" content="Wald · NoLimits.jl"/><meta property="og:title" content="Wald · NoLimits.jl"/><meta property="twitter:title" content="Wald · NoLimits.jl"/><meta name="description" content="Documentation for NoLimits.jl."/><meta property="og:description" content="Documentation for NoLimits.jl."/><meta property="twitter:description" content="Documentation for NoLimits.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NoLimits.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../capabilities/">Capabilities</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Building</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model-building/">Overview</a></li><li><a class="tocitem" href="../../model-building/model-macro/">@Model</a></li><li><a class="tocitem" href="../../model-building/helpers/">@helpers</a></li><li><a class="tocitem" href="../../model-building/fixed-effects/">@fixedEffects</a></li><li><a class="tocitem" href="../../model-building/covariates/">@covariates</a></li><li><a class="tocitem" href="../../model-building/random-effects/">@randomEffects</a></li><li><a class="tocitem" href="../../model-building/pre-differential-equation/">@preDifferentialEquation</a></li><li><a class="tocitem" href="../../model-building/differential-equation/">@DifferentialEquation</a></li><li><a class="tocitem" href="../../model-building/initial-de/">@initialDE</a></li><li><a class="tocitem" href="../../model-building/formulas/">@formulas</a></li><li><a class="tocitem" href="../../model-building/universal-function-approximators/">Function Approximators (NNs + SoftTrees)</a></li></ul></li><li><a class="tocitem" href="../../data-model-construction/">Data Model Construction</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../estimation/">Overview</a></li><li><a class="tocitem" href="../../estimation/laplace/">Laplace</a></li><li><a class="tocitem" href="../../estimation/laplace-map/">Laplace MAP</a></li><li><a class="tocitem" href="../../estimation/mcem/">MCEM</a></li><li><a class="tocitem" href="../../estimation/saem/">SAEM</a></li><li><a class="tocitem" href="../../estimation/mcmc/">MCMC</a></li><li><a class="tocitem" href="../../estimation/mle/">MLE</a></li><li><a class="tocitem" href="../../estimation/mle-map/">MAP</a></li><li><a class="tocitem" href="../../estimation/multistart/">Multistart</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Uncertainty Quantification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li class="is-active"><a class="tocitem" href>Wald</a><ul class="internal"><li><a class="tocitem" href="#Applicability"><span>Applicability</span></a></li><li><a class="tocitem" href="#Minimal-Usage"><span>Minimal Usage</span></a></li><li><a class="tocitem" href="#Covariance-Choice"><span>Covariance Choice</span></a></li><li><a class="tocitem" href="#Numerical-Robustness-Controls"><span>Numerical Robustness Controls</span></a></li><li><a class="tocitem" href="#MCEM/SAEM-Approximation-Controls"><span>MCEM/SAEM Approximation Controls</span></a></li><li><a class="tocitem" href="#Parameter-Inclusion-Rules"><span>Parameter Inclusion Rules</span></a></li><li><a class="tocitem" href="#Fit-Kwarg-Forwarding"><span>Fit-Kwarg Forwarding</span></a></li><li><a class="tocitem" href="#Returned-Quantities"><span>Returned Quantities</span></a></li></ul></li><li><a class="tocitem" href="../profile-likelihood/">Profile likelihood</a></li><li><a class="tocitem" href="../mcmc-based-uncertainty/">MCMC-based uncertainty</a></li></ul></li><li><a class="tocitem" href="../../plotting/">Plotting</a></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/mixed-effects-multiple-methods/">Mixed-Effects Tutorial 1: Nonlinear Random-Effects Model Across Multiple Estimation Methods</a></li><li><a class="tocitem" href="../../tutorials/mixed-effects-ode-mcem/">Mixed-Effects Tutorial 2: ODE Model with Dosing Events (MCEM)</a></li><li><a class="tocitem" href="../../tutorials/mixed-effects-nn-saem/">Mixed-Effects Tutorial 3: Neural Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../../tutorials/mixed-effects-softtree-saem/">Mixed-Effects Tutorial 4: SoftTree Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../../tutorials/mixed-effects-seizure-counts-poisson-nb-mcem/">Mixed-Effects Tutorial 5: Seizure Counts with Poisson and NegativeBinomial Outcomes (MCEM)</a></li><li><a class="tocitem" href="../../tutorials/mixed-effects-left-censored-virload50-laplace/">Mixed-Effects Tutorial 6: Left-Censored Nonlinear Model (Laplace)</a></li><li><a class="tocitem" href="../../tutorials/fixed-effects-nonlinear-mle-map/">Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a></li></ul></li><li><a class="tocitem" href="../../how-to-contribute/">How to Contribute</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Uncertainty Quantification</a></li><li class="is-active"><a href>Wald</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wald</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl/blob/main/docs/src/uncertainty-quantification/wald.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Wald"><a class="docs-heading-anchor" href="#Wald">Wald</a><a id="Wald-1"></a><a class="docs-heading-anchor-permalink" href="#Wald" title="Permalink"></a></h1><p>The Wald method is the most widely used approach to uncertainty quantification for maximum likelihood and related estimators. It approximates the log-likelihood surface as locally quadratic at the optimum, yielding a Gaussian approximation to the sampling distribution of the parameter estimates. This approximation is computationally inexpensive and accurate when the model is well-identified and the sample size is adequate.</p><p>In NoLimits.jl, Wald UQ is accessed via <code>compute_uq(...; method=:wald)</code>. It constructs an approximate variance-covariance matrix for eligible fixed-effect coordinates, then draws from the implied Gaussian distribution to form confidence intervals.</p><p>For visualization of Wald-based densities, closed-form curves are used when available:</p><ul><li><strong>Transformed scale:</strong> Normal distribution (closed form).</li><li><strong>Natural scale:</strong> Normal for identity-scale coordinates; LogNormal for log-scale coordinates.</li><li><strong>Other cases:</strong> draw-based kernel density estimation (KDE) is used as a fallback.</li></ul><h2 id="Applicability"><a class="docs-heading-anchor" href="#Applicability">Applicability</a><a id="Applicability-1"></a><a class="docs-heading-anchor-permalink" href="#Applicability" title="Permalink"></a></h2><p>Wald UQ is supported for results from the following estimation methods:</p><ul><li>Fixed-effects fits: <code>MLE</code> and <code>MAP</code></li><li>Mixed-effects fits: <code>Laplace</code>, <code>LaplaceMAP</code>, <code>MCEM</code>, and <code>SAEM</code></li></ul><h2 id="Minimal-Usage"><a class="docs-heading-anchor" href="#Minimal-Usage">Minimal Usage</a><a id="Minimal-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Minimal-Usage" title="Permalink"></a></h2><pre><code class="language-julia hljs">using NoLimits

uq = compute_uq(
    res;
    method=:wald,
    level=0.95,
    vcov=:hessian,
    n_draws=2000,
)</code></pre><h2 id="Covariance-Choice"><a class="docs-heading-anchor" href="#Covariance-Choice">Covariance Choice</a><a id="Covariance-Choice-1"></a><a class="docs-heading-anchor-permalink" href="#Covariance-Choice" title="Permalink"></a></h2><p>The <code>vcov</code> argument selects the variance-covariance estimator.</p><ul><li><code>vcov=:hessian</code>: computes the covariance as the inverse of the observed information (Hessian) matrix. This is the standard choice when the model is correctly specified.</li><li><code>vcov=:sandwich</code>: computes the sandwich (robust) covariance estimator, which provides consistent standard errors even under mild model misspecification.</li></ul><pre><code class="language-julia hljs">uq_hessian = compute_uq(res; method=:wald, vcov=:hessian, n_draws=1000)
uq_sandwich = compute_uq(res; method=:wald, vcov=:sandwich, n_draws=1000)</code></pre><h2 id="Numerical-Robustness-Controls"><a class="docs-heading-anchor" href="#Numerical-Robustness-Controls">Numerical Robustness Controls</a><a id="Numerical-Robustness-Controls-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Robustness-Controls" title="Permalink"></a></h2><p>When the Hessian is poorly conditioned – for example, because the log-likelihood surface is locally flat along certain parameter directions – the following controls can improve numerical stability:</p><ul><li><code>pseudo_inverse</code>: use the Moore-Penrose pseudo-inverse when direct matrix inversion is numerically unstable.</li><li><code>hessian_backend</code>: choose the differentiation strategy – <code>:auto</code>, <code>:forwarddiff</code>, or <code>:fd_gradient</code> (finite-difference based).</li><li><code>fd_abs_step</code>: absolute step size for finite-difference computation.</li><li><code>fd_rel_step</code>: relative step size for finite-difference computation.</li><li><code>fd_max_tries</code>: maximum number of retry attempts for finite-difference gradient and Hessian evaluations.</li></ul><pre><code class="language-julia hljs">uq_robust = compute_uq(
    res;
    method=:wald,
    pseudo_inverse=true,
    hessian_backend=:fd_gradient,
    fd_abs_step=1e-4,
    fd_rel_step=1e-3,
    fd_max_tries=8,
    n_draws=1500,
)</code></pre><p>When the covariance matrix requires projection to restore positive semi-definiteness, this is reported in the diagnostics (via <code>vcov_projected</code> and eigenvalue-related fields).</p><h2 id="MCEM/SAEM-Approximation-Controls"><a class="docs-heading-anchor" href="#MCEM/SAEM-Approximation-Controls">MCEM/SAEM Approximation Controls</a><a id="MCEM/SAEM-Approximation-Controls-1"></a><a class="docs-heading-anchor-permalink" href="#MCEM/SAEM-Approximation-Controls" title="Permalink"></a></h2><p>For fits obtained with <code>MCEM</code> or <code>SAEM</code>, the marginal likelihood is not available in closed form, so the Hessian cannot be computed directly from the EM objective. In these cases, the Wald backend uses a random-effects approximation method (typically Laplace) during the Hessian evaluation.</p><ul><li><code>re_approx=:auto</code> (the default) selects a Laplace-style approximation automatically.</li><li><code>re_approx_method</code> allows passing an explicit approximation method instance for finer control.</li></ul><pre><code class="language-julia hljs">if @isdefined(res_saem) &amp;&amp; res_saem !== nothing
    uq_saem = compute_uq(
        res_saem;
        method=:wald,
        re_approx=:laplace,
        n_draws=800,
    )
end

if @isdefined(res_mcem) &amp;&amp; res_mcem !== nothing
    uq_mcem_custom = compute_uq(
        res_mcem;
        method=:wald,
        re_approx_method=NoLimits.Laplace(; multistart_n=0, multistart_k=0),
        n_draws=800,
    )
end</code></pre><h3 id="Choosing-n_draws"><a class="docs-heading-anchor" href="#Choosing-n_draws">Choosing <code>n_draws</code></a><a id="Choosing-n_draws-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-n_draws" title="Permalink"></a></h3><p>The <code>n_draws</code> parameter controls the number of Monte Carlo samples drawn from the Wald Gaussian approximation. These draws are used to compute draw-based summaries (accessible via <code>get_uq_draws</code>), interval estimates, and the natural-scale covariance matrix.</p><p>Importantly, <code>n_draws</code> does not affect the transformed-scale covariance matrix itself (<code>get_uq_vcov(...; scale=:transformed)</code>), which is derived directly from the Hessian or sandwich calculation.</p><p>Guidelines for setting <code>n_draws</code>:</p><ul><li><strong>Lower values</strong> (e.g., a few hundred): faster computation, but with greater Monte Carlo variability in the resulting intervals.</li><li><strong>Higher values</strong> (e.g., several thousand): more stable interval estimates at the cost of additional computation.</li></ul><p>The value <code>n_draws=800</code> used in examples above represents a practical middle ground for interactive exploration. For final reporting, it is advisable to increase <code>n_draws</code> and verify stability by rerunning with a different <code>rng</code> seed.</p><p>For density visualization via <code>plot_uq_distributions</code>, the distinction between closed-form and draw-based densities becomes relevant:</p><ul><li>Identity-scale and log-scale coordinates use closed-form Normal or LogNormal density curves, independent of <code>n_draws</code>.</li><li>Coordinates requiring nontrivial inverse transforms (e.g., PSD matrix elements parameterized via <code>:cholesky</code> or <code>:expm</code>) rely on draw-based KDE, making the draw count important for plot quality.</li></ul><h2 id="Parameter-Inclusion-Rules"><a class="docs-heading-anchor" href="#Parameter-Inclusion-Rules">Parameter Inclusion Rules</a><a id="Parameter-Inclusion-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Inclusion-Rules" title="Permalink"></a></h2><p>Wald UQ is computed only on the subset of free fixed-effect coordinates that are eligible for uncertainty calculation.</p><p>A coordinate is excluded when:</p><ul><li>its fixed effect is held constant via <code>constants</code>, or</li><li>its parameter block has <code>calculate_se=false</code>.</li></ul><p>If no eligible coordinates remain after exclusion, Wald UQ raises an error.</p><pre><code class="language-julia hljs">fe = @fixedEffects begin
    a = RealNumber(0.2, calculate_se=true)                 # included
    b = RealNumber(0.1, calculate_se=false)                # excluded
    sigma = RealNumber(0.3, scale=:log, calculate_se=true) # included
end

uq = compute_uq(res; method=:wald, constants=(; a=0.2))</code></pre><p>In this example, <code>a</code> is also excluded because it is fixed by <code>constants</code>, leaving only <code>sigma</code> in the UQ computation.</p><h2 id="Fit-Kwarg-Forwarding"><a class="docs-heading-anchor" href="#Fit-Kwarg-Forwarding">Fit-Kwarg Forwarding</a><a id="Fit-Kwarg-Forwarding-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-Kwarg-Forwarding" title="Permalink"></a></h2><p><code>compute_uq(...; method=:wald)</code> accepts overrides for fit-related settings that may differ from those used during the original estimation:</p><ul><li><code>constants</code></li><li><code>constants_re</code></li><li><code>penalty</code></li><li><code>ode_args</code>, <code>ode_kwargs</code></li><li><code>serialization</code></li><li><code>rng</code></li></ul><p>When these are omitted, the values stored from the original fit are used.</p><h2 id="Returned-Quantities"><a class="docs-heading-anchor" href="#Returned-Quantities">Returned Quantities</a><a id="Returned-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Returned-Quantities" title="Permalink"></a></h2><p>Wald UQ returns a <code>UQResult</code> with backend <code>:wald</code>. The full set of accessor functions is shown below.</p><pre><code class="language-julia hljs">backend = get_uq_backend(uq)                 # :wald
source = get_uq_source_method(uq)            # original fit method symbol
names = get_uq_parameter_names(uq)

est_nat = get_uq_estimates(uq; scale=:natural)
est_tr = get_uq_estimates(uq; scale=:transformed)

ints_nat = get_uq_intervals(uq; scale=:natural)
ints_tr = get_uq_intervals(uq; scale=:transformed)

V_nat = get_uq_vcov(uq; scale=:natural)
V_tr = get_uq_vcov(uq; scale=:transformed)

draws_nat = get_uq_draws(uq; scale=:natural)
draws_tr = get_uq_draws(uq; scale=:transformed)

diag = get_uq_diagnostics(uq)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Overview</a><a class="docs-footer-nextpage" href="../profile-likelihood/">Profile likelihood »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 20 February 2026 09:14">Friday 20 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

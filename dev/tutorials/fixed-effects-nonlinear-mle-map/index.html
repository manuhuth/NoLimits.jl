<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP) · NoLimits.jl</title><meta name="title" content="Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP) · NoLimits.jl"/><meta property="og:title" content="Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP) · NoLimits.jl"/><meta property="twitter:title" content="Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP) · NoLimits.jl"/><meta name="description" content="Documentation for NoLimits.jl."/><meta property="og:description" content="Documentation for NoLimits.jl."/><meta property="twitter:description" content="Documentation for NoLimits.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NoLimits.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../capabilities/">Capabilities</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Building</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model-building/">Overview</a></li><li><a class="tocitem" href="../../model-building/model-macro/">@Model</a></li><li><a class="tocitem" href="../../model-building/helpers/">@helpers</a></li><li><a class="tocitem" href="../../model-building/fixed-effects/">@fixedEffects</a></li><li><a class="tocitem" href="../../model-building/covariates/">@covariates</a></li><li><a class="tocitem" href="../../model-building/random-effects/">@randomEffects</a></li><li><a class="tocitem" href="../../model-building/pre-differential-equation/">@preDifferentialEquation</a></li><li><a class="tocitem" href="../../model-building/differential-equation/">@DifferentialEquation</a></li><li><a class="tocitem" href="../../model-building/initial-de/">@initialDE</a></li><li><a class="tocitem" href="../../model-building/formulas/">@formulas</a></li><li><a class="tocitem" href="../../model-building/universal-function-approximators/">Function Approximators (NNs + SoftTrees)</a></li></ul></li><li><a class="tocitem" href="../../data-model-construction/">Data Model Construction</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../estimation/">Overview</a></li><li><a class="tocitem" href="../../estimation/laplace/">Laplace</a></li><li><a class="tocitem" href="../../estimation/laplace-map/">Laplace MAP</a></li><li><a class="tocitem" href="../../estimation/mcem/">MCEM</a></li><li><a class="tocitem" href="../../estimation/saem/">SAEM</a></li><li><a class="tocitem" href="../../estimation/mcmc/">MCMC</a></li><li><a class="tocitem" href="../../estimation/vi/">VI</a></li><li><a class="tocitem" href="../../estimation/mle/">MLE</a></li><li><a class="tocitem" href="../../estimation/mle-map/">MAP</a></li><li><a class="tocitem" href="../../estimation/multistart/">Multistart</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Uncertainty Quantification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../uncertainty-quantification/">Overview</a></li><li><a class="tocitem" href="../../uncertainty-quantification/wald/">Wald</a></li><li><a class="tocitem" href="../../uncertainty-quantification/profile-likelihood/">Profile likelihood</a></li><li><a class="tocitem" href="../../uncertainty-quantification/mcmc-based-uncertainty/">MCMC-based uncertainty</a></li></ul></li><li><a class="tocitem" href="../../plotting/">Plotting</a></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox" checked/><label class="tocitem" for="menuitem-9"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mixed-effects-multiple-methods/">Mixed-Effects Tutorial 1: Nonlinear Random-Effects Model Across Multiple Estimation Methods</a></li><li><a class="tocitem" href="../mixed-effects-ode-mcem/">Mixed-Effects Tutorial 2: ODE Model with Dosing Events (MCEM)</a></li><li><a class="tocitem" href="../mixed-effects-nn-saem/">Mixed-Effects Tutorial 3: Neural Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../mixed-effects-softtree-saem/">Mixed-Effects Tutorial 4: SoftTree Differential-Equation Components (SAEM)</a></li><li><a class="tocitem" href="../mixed-effects-seizure-counts-poisson-nb-mcem/">Mixed-Effects Tutorial 5: Seizure Counts with Poisson and NegativeBinomial Outcomes (MCEM)</a></li><li><a class="tocitem" href="../mixed-effects-left-censored-virload50-laplace/">Mixed-Effects Tutorial 6: Left-Censored Nonlinear Model (Laplace)</a></li><li><a class="tocitem" href="../mixed-effects-vi/">Mixed-Effects Tutorial 7: Variational Inference (VI)</a></li><li class="is-active"><a class="tocitem" href>Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a><ul class="internal"><li><a class="tocitem" href="#What-You-Will-Learn"><span>What You Will Learn</span></a></li><li><a class="tocitem" href="#Step-1:-Load-the-Data"><span>Step 1: Load the Data</span></a></li><li><a class="tocitem" href="#Step-2:-Define-a-Nonlinear-Fixed-Effects-Model"><span>Step 2: Define a Nonlinear Fixed-Effects Model</span></a></li><li><a class="tocitem" href="#Step-3:-Build-the-DataModel-and-Configure-Estimation"><span>Step 3: Build the DataModel and Configure Estimation</span></a></li><li><a class="tocitem" href="#Step-4:-Fit-with-MLE-and-MAP"><span>Step 4: Fit with MLE and MAP</span></a></li><li><a class="tocitem" href="#Step-5:-Compare-Parameter-Estimates"><span>Step 5: Compare Parameter Estimates</span></a></li><li><a class="tocitem" href="#Step-6:-Fitted-Trajectories"><span>Step 6: Fitted Trajectories</span></a></li><li><a class="tocitem" href="#Step-7:-Observation-Distribution-Diagnostics"><span>Step 7: Observation Distribution Diagnostics</span></a></li><li><a class="tocitem" href="#Summary-and-Next-Steps"><span>Summary and Next Steps</span></a></li></ul></li><li><a class="tocitem" href="../fixed-effects-vi/">Fixed-Effects Tutorial 2: Variational Inference (VI)</a></li></ul></li><li><a class="tocitem" href="../../how-to-contribute/">How to Contribute</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/manuhuth/NoLimits.jl/blob/main/docs/src/tutorials/fixed-effects-nonlinear-mle-map.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fixed-Effects-Tutorial-1:-Nonlinear-Longitudinal-Model-(MLE-MAP)"><a class="docs-heading-anchor" href="#Fixed-Effects-Tutorial-1:-Nonlinear-Longitudinal-Model-(MLE-MAP)">Fixed-Effects Tutorial 1: Nonlinear Longitudinal Model (MLE + MAP)</a><a id="Fixed-Effects-Tutorial-1:-Nonlinear-Longitudinal-Model-(MLE-MAP)-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-Effects-Tutorial-1:-Nonlinear-Longitudinal-Model-(MLE-MAP)" title="Permalink"></a></h1><p>Many biological processes – organ growth, tumor progression, enzyme saturation – follow sigmoidal trajectories that cannot be captured by linear regression. Fitting such curves to repeated measurements collected over time is a core task in longitudinal data analysis. In this tutorial, you will build a logistic growth model for tree-trunk circumference data, estimate its parameters with two complementary methods (maximum likelihood and maximum a posteriori), and examine how prior information shapes the result. No random effects are introduced here; a later tutorial extends the same model to account for inter-subject variability.</p><h2 id="What-You-Will-Learn"><a class="docs-heading-anchor" href="#What-You-Will-Learn">What You Will Learn</a><a id="What-You-Will-Learn-1"></a><a class="docs-heading-anchor-permalink" href="#What-You-Will-Learn" title="Permalink"></a></h2><p>This tutorial walks through the complete modelling cycle for a fixed-effects nonlinear model in NoLimits.jl. Along the way you will learn how to:</p><ul><li><strong>Translate a scientific growth equation</strong> into a NoLimits model specification.</li><li><strong>Connect that specification to observed data</strong> by constructing a <code>DataModel</code>.</li><li><strong>Estimate parameters under two philosophies.</strong> Maximum likelihood estimation (MLE) finds the parameter values that make the observed data most probable, treating the likelihood as the sole objective. Maximum a posteriori estimation (MAP) augments the likelihood with prior distributions on the parameters, which can improve numerical stability when some parameters are weakly identified – a common situation with sigmoidal models whose asymptote or inflection point lies outside the observed time window.</li><li><strong>Compare and diagnose</strong> the resulting estimates by visualising fitted trajectories and inspecting observation-level distributions.</li></ul><p>By the end, you will have a working template that you can adapt to your own nonlinear longitudinal datasets.</p><h2 id="Step-1:-Load-the-Data"><a class="docs-heading-anchor" href="#Step-1:-Load-the-Data">Step 1: Load the Data</a><a id="Step-1:-Load-the-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Load-the-Data" title="Permalink"></a></h2><p>In this step, you will load the dataset used throughout the tutorial: the classic Orange tree growth study, originally published by Draper and Smith and available in R as <code>datasets::Orange</code>. It records the trunk circumference of five orange trees measured at seven time points each, making it a compact but representative example of nonlinear longitudinal data.</p><pre><code class="language-julia hljs">using NoLimits
using CSV
using DataFrames
using Distributions
using Downloads
using Random
using SciMLBase

include(joinpath(@__DIR__, &quot;_data_loaders.jl&quot;))

Random.seed!(202)

df = load_orange()

first(df, 8)</code></pre><p>Each row records one measurement occasion. The <code>Tree</code> column identifies the individual, <code>age</code> gives the tree&#39;s age in days since planting, and <code>circumference</code> is the trunk circumference in millimetres. Because every tree is measured at the same set of ages, this is a balanced design – convenient for illustration, though NoLimits.jl handles unbalanced data equally well.</p><h2 id="Step-2:-Define-a-Nonlinear-Fixed-Effects-Model"><a class="docs-heading-anchor" href="#Step-2:-Define-a-Nonlinear-Fixed-Effects-Model">Step 2: Define a Nonlinear Fixed-Effects Model</a><a id="Step-2:-Define-a-Nonlinear-Fixed-Effects-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Define-a-Nonlinear-Fixed-Effects-Model" title="Permalink"></a></h2><p>In this step, you will express the scientific model as a NoLimits model specification. The structural model is a three-parameter logistic growth curve, one of the simplest sigmoidal functions used in biology:</p><p class="math-container">\[\mu(t) = \frac{a}{1 + \exp\!\bigl(-k\,(t - t_0)\bigr)}\]</p><p>Here, <code>a</code> sets the upper asymptote (the maximum circumference the model can predict), <code>k</code> controls the steepness of the growth phase, and <code>t0</code> locates the inflection point – the age at which growth is fastest. Observations are assumed normally distributed around this deterministic trajectory with standard deviation <code>sigma</code>.</p><p>Notice that we also attach prior distributions to each parameter. MLE will ignore these priors entirely, but they become essential for MAP estimation in Step 4. The priors encode only weak domain knowledge: circumferences are positive and on the order of tens to hundreds of millimetres, growth rates are small and positive, and the inflection point falls somewhere within the range of observed ages.</p><pre><code class="language-julia hljs">using NoLimits
using Distributions

model = @Model begin
    @covariates begin
        age = Covariate()
    end

    @fixedEffects begin
        a = RealNumber(100.0, prior=Normal(100.0, 30.0), calculate_se=true)
        k = RealNumber(0.01, prior=Normal(0.01, 0.01), calculate_se=true)
        t0 = RealNumber(500.0, prior=Normal(500.0, 200.0), calculate_se=true)
        σ = RealNumber(5.0, scale=:log, prior=LogNormal(1.0, 0.5), calculate_se=true)
    end

    @formulas begin
        μ = a / (1 + exp(-k * (age - t0)))
        circumference ~ Normal(μ, σ)
    end
end</code></pre><p>A few points worth noting about this specification. The <code>@covariates</code> block declares <code>age</code> as a time-varying covariate, which tells NoLimits to look up a column called <code>age</code> in the data frame. The residual standard deviation <code>sigma</code> is parameterised on the log scale (<code>scale=:log</code>), which constrains it to be strictly positive during optimisation without requiring explicit bounds. Finally, the <code>@formulas</code> block first computes the deterministic prediction <code>mu</code> and then declares that the observed column <code>circumference</code> follows a normal distribution centred on that prediction.</p><h3 id="Model-Summary"><a class="docs-heading-anchor" href="#Model-Summary">Model Summary</a><a id="Model-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Summary" title="Permalink"></a></h3><p>Before fitting, it is good practice to inspect the model structure programmatically. The summary confirms which parameters are declared as fixed effects, which covariates are expected, and what form the observation model takes.</p><pre><code class="language-julia hljs">model_summary = NoLimits.summarize(model)
model_summary</code></pre><h2 id="Step-3:-Build-the-DataModel-and-Configure-Estimation"><a class="docs-heading-anchor" href="#Step-3:-Build-the-DataModel-and-Configure-Estimation">Step 3: Build the DataModel and Configure Estimation</a><a id="Step-3:-Build-the-DataModel-and-Configure-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Build-the-DataModel-and-Configure-Estimation" title="Permalink"></a></h2><p>With the model and data in hand, you will now pair them into a <code>DataModel</code> – the central object that validates the data against the model specification and prepares the internal structures needed for estimation. In the same step, you will configure the two estimation methods (MLE and MAP), specifying a maximum of 150 optimiser iterations for each.</p><pre><code class="language-julia hljs">dm = DataModel(model, df; primary_id=:Tree, time_col=:age)

mle_method = NoLimits.MLE(; optim_kwargs=(maxiters=150,))
map_method = NoLimits.MAP(; optim_kwargs=(maxiters=150,))

serialization = SciMLBase.EnsembleThreads()</code></pre><p>The <code>primary_id=:Tree</code> argument tells NoLimits which column identifies individuals, and <code>time_col=:age</code> specifies the time axis. Setting <code>serialization=EnsembleThreads()</code> enables multi-threaded likelihood evaluation across individuals – a minor convenience here with only five trees, but essential for larger datasets where per-individual computations dominate runtime.</p><h3 id="DataModel-Summary"><a class="docs-heading-anchor" href="#DataModel-Summary">DataModel Summary</a><a id="DataModel-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#DataModel-Summary" title="Permalink"></a></h3><p>It is worth verifying that the data were parsed correctly. The summary should confirm five individuals, seven observations each, no missing values, and no events.</p><pre><code class="language-julia hljs">dm_summary = NoLimits.summarize(dm)
dm_summary</code></pre><h2 id="Step-4:-Fit-with-MLE-and-MAP"><a class="docs-heading-anchor" href="#Step-4:-Fit-with-MLE-and-MAP">Step 4: Fit with MLE and MAP</a><a id="Step-4:-Fit-with-MLE-and-MAP-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4:-Fit-with-MLE-and-MAP" title="Permalink"></a></h2><p>You are now ready to estimate the model parameters under both methods. Each call to <code>fit_model</code> runs a gradient-based optimiser (L-BFGS by default), starting from the initial values declared in the <code>@fixedEffects</code> block. The key difference lies in the objective function: MLE maximises the log-likelihood alone, while MAP maximises the log-likelihood plus the log-prior.</p><pre><code class="language-julia hljs">res_mle = fit_model(dm, mle_method; serialization=serialization, rng=Random.Xoshiro(41))
res_map = fit_model(dm, map_method; serialization=serialization, rng=Random.Xoshiro(42))

(
    objective_mle=NoLimits.get_objective(res_mle),
    objective_map=NoLimits.get_objective(res_map),
)</code></pre><p>The returned objective values are negative log-likelihoods (for MLE) or negative log-posteriors (for MAP), so lower values indicate a better fit. Because the MAP objective includes additional prior penalty terms, its numerical value is not directly comparable to the MLE objective; what matters at this stage is that each method converged successfully.</p><p>To verify convergence and examine standard errors, you can request a detailed fit summary. This reports convergence status, the final objective value, and standard errors for all parameters whose <code>calculate_se</code> flag was set to <code>true</code>.</p><pre><code class="language-julia hljs">fit_summary_mle = NoLimits.summarize(res_mle)
fit_summary_map = NoLimits.summarize(res_map)

fit_summary_mle</code></pre><h2 id="Step-5:-Compare-Parameter-Estimates"><a class="docs-heading-anchor" href="#Step-5:-Compare-Parameter-Estimates">Step 5: Compare Parameter Estimates</a><a id="Step-5:-Compare-Parameter-Estimates-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5:-Compare-Parameter-Estimates" title="Permalink"></a></h2><p>With both fits complete, you can now extract the estimated parameters on the original (untransformed) scale and compare them side by side.</p><pre><code class="language-julia hljs">θ_mle = NoLimits.get_params(res_mle; scale=:untransformed)
θ_map = NoLimits.get_params(res_map; scale=:untransformed)

(
    mle=θ_mle,
    map=θ_map,
)</code></pre><p>Because this dataset is relatively small (35 observations total), the priors exert a noticeable pull on the MAP estimates. In particular, parameters whose likelihood surface is flat – such as the asymptote <code>a</code>, which is only weakly constrained when few trees have approached their maximum size – will be drawn toward the prior mean under MAP but left at the pure likelihood optimum under MLE. As sample size grows, the likelihood dominates and the two methods converge to the same values. This behaviour serves as a useful diagnostic: large MLE–MAP discrepancies flag parameters that the data alone cannot pin down precisely.</p><h2 id="Step-6:-Fitted-Trajectories"><a class="docs-heading-anchor" href="#Step-6:-Fitted-Trajectories">Step 6: Fitted Trajectories</a><a id="Step-6:-Fitted-Trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Step-6:-Fitted-Trajectories" title="Permalink"></a></h2><p>Plotting model predictions against raw observations is the most direct way to assess goodness of fit. In this step, you will overlay the estimated logistic curves on the data for the first two trees under each estimation method.</p><pre><code class="language-julia hljs">inds = [1, 2]

p_fit_mle = plot_fits(
    res_mle;
    observable=:circumference,
    individuals_idx=inds,
    ncols=2,
    shared_x_axis=true,
    shared_y_axis=true,
)

p_fit_map = plot_fits(
    res_map;
    observable=:circumference,
    individuals_idx=inds,
    ncols=2,
    shared_x_axis=true,
    shared_y_axis=true,
)</code></pre><p>MLE fit plot:</p><pre><code class="language-julia hljs">p_fit_mle</code></pre><p>Because there are no random effects in this model, every tree is predicted by the same population-level curve. Deviations between the curve and individual data points therefore reflect both measurement noise and genuine between-tree variability that the current model does not capture. If these residual patterns appear systematic – for example, if one tree consistently lies above the curve while another lies below – that is a strong signal that random effects should be introduced (see the mixed-effects tutorials).</p><p>MAP fit plot:</p><pre><code class="language-julia hljs">p_fit_map</code></pre><p>The MAP trajectories may appear nearly identical to the MLE trajectories or show subtle shifts, depending on how informative the priors are relative to the data. Comparing the two plots is a quick visual assessment of prior influence.</p><h2 id="Step-7:-Observation-Distribution-Diagnostics"><a class="docs-heading-anchor" href="#Step-7:-Observation-Distribution-Diagnostics">Step 7: Observation Distribution Diagnostics</a><a id="Step-7:-Observation-Distribution-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Step-7:-Observation-Distribution-Diagnostics" title="Permalink"></a></h2><p>Beyond trajectory plots, it is informative to inspect the implied observation distribution at individual time points. In this step, you will plot the normal distribution predicted by the model at the first observation of the first tree, with the actual observed value marked. A well-calibrated model places observed values near the centre of the predicted distribution rather than in the tails.</p><pre><code class="language-julia hljs">p_obs_mle = plot_observation_distributions(
    res_mle;
    observables=:circumference,
    individuals_idx=1,
    obs_rows=1,
)

p_obs_map = plot_observation_distributions(
    res_map;
    observables=:circumference,
    individuals_idx=1,
    obs_rows=1,
)</code></pre><p>MLE observation-distribution plot:</p><pre><code class="language-julia hljs">p_obs_mle</code></pre><p>MAP observation-distribution plot:</p><pre><code class="language-julia hljs">p_obs_map</code></pre><p>If an observed value sits far in the tail of the predicted distribution, this may indicate model misspecification – for instance, a residual error distribution that is too narrow, or a structural model that systematically over- or under-predicts at certain ages.</p><h2 id="Summary-and-Next-Steps"><a class="docs-heading-anchor" href="#Summary-and-Next-Steps">Summary and Next Steps</a><a id="Summary-and-Next-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-and-Next-Steps" title="Permalink"></a></h2><p>This tutorial demonstrated the end-to-end workflow for fixed-effects nonlinear modelling in NoLimits.jl: specifying a scientifically motivated structural model, pairing it with data, estimating parameters via MLE and MAP, and diagnosing the results. Several practical points are worth keeping in mind:</p><ul><li><strong>MLE is purely data-driven.</strong> It finds the parameter values that maximise the likelihood of the observed data. Declared priors have no effect on the MLE objective.</li><li><strong>MAP incorporates prior knowledge.</strong> By adding log-prior terms to the objective, MAP can stabilise estimation when the data provide limited information about certain parameters – a common situation in nonlinear models with saturation or asymptotic behaviour.</li><li><strong>Fixed-effects models assume no between-subject variability.</strong> Every individual is predicted by the same curve. When individual trajectories diverge systematically, random effects are needed to account for that heterogeneity. The mixed-effects tutorials show how to extend this model accordingly.</li><li><strong>Diagnostic tools are method-agnostic.</strong> Whether you use MLE, MAP, or any other estimation method in NoLimits.jl, functions such as <code>plot_fits</code> and <code>plot_observation_distributions</code> work identically, making it straightforward to compare results across methods.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mixed-effects-vi/">« Mixed-Effects Tutorial 7: Variational Inference (VI)</a><a class="docs-footer-nextpage" href="../fixed-effects-vi/">Fixed-Effects Tutorial 2: Variational Inference (VI) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Wednesday 25 February 2026 18:47">Wednesday 25 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
